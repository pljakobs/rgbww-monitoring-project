# Telegraf configuration for RGBWW MQTT monitoring
[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  precision = ""
  hostname = ""
  omit_hostname = false
  skip_processors_after_aggregators = false

[[outputs.influxdb_v2]]
  urls = ["http://rgbww-influxdb:8086"]
  token = "$INFLUX_TOKEN"
  organization = "default"
  bucket = "rgbww"

[[inputs.mqtt_consumer]]
  servers = ["tcp://lightinator.de:1883"]
  topics = ["rgbww/+/monitor"]
  topic_tag = "topic"
  persistent_session = false
  client_id = "influxdb scaper"
  username = "rgbww"
  password = "rgbwwdebug"
  data_format = "json"

  # Parse controller id from topic as tag
  [[inputs.mqtt_consumer.topic_parsing]]
    topic = "rgbww/(+)/monitor"
    tags = "id"
    measurement = "mqtt_consumer"

  # JSON parsing options removed for Telegraf v1.40.0 compatibility

[[inputs.internal]]
